var Module=(()=>{var _scriptDir=import.meta.url;return async function(moduleArg={}){var Module2=moduleArg,readyPromiseResolve,readyPromiseReject;Module2.ready=new Promise((resolve,reject)=>{readyPromiseResolve=resolve,readyPromiseReject=reject});var moduleOverrides=Object.assign({},Module2),arguments_=[],thisProgram="./this.program",quit_=(status,toThrow)=>{throw toThrow},ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof importScripts=="function",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",scriptDirectory="";function locateFile(path){return Module2.locateFile?Module2.locateFile(path,scriptDirectory):scriptDirectory+path}var read_,readAsync,readBinary;if(ENVIRONMENT_IS_NODE){let{createRequire}=await import("module");var require2=createRequire(import.meta.url),fs=require2("fs"),nodePath=require2("path");ENVIRONMENT_IS_WORKER?scriptDirectory=nodePath.dirname(scriptDirectory)+"/":scriptDirectory=require2("url").fileURLToPath(new URL("./",import.meta.url)),read_=(filename,binary)=>(filename=isFileURI(filename)?new URL(filename):nodePath.normalize(filename),fs.readFileSync(filename,binary?void 0:"utf8")),readBinary=filename=>{var ret=read_(filename,!0);return ret.buffer||(ret=new Uint8Array(ret)),ret},readAsync=(filename,onload,onerror,binary=!0)=>{filename=isFileURI(filename)?new URL(filename):nodePath.normalize(filename),fs.readFile(filename,binary?void 0:"utf8",(err2,data)=>{err2?onerror(err2):onload(binary?data.buffer:data)})},!Module2.thisProgram&&process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),process.on("uncaughtException",ex=>{if(ex!=="unwind"&&!(ex instanceof ExitStatus)&&!(ex.context instanceof ExitStatus))throw ex}),quit_=(status,toThrow)=>{throw process.exitCode=status,toThrow}}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:typeof document<"u"&&document.currentScript&&(scriptDirectory=document.currentScript.src),_scriptDir&&(scriptDirectory=_scriptDir),scriptDirectory.indexOf("blob:")!==0?scriptDirectory=scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1):scriptDirectory="",read_=url=>{var xhr=new XMLHttpRequest;return xhr.open("GET",url,!1),xhr.send(null),xhr.responseText},ENVIRONMENT_IS_WORKER&&(readBinary=url=>{var xhr=new XMLHttpRequest;return xhr.open("GET",url,!1),xhr.responseType="arraybuffer",xhr.send(null),new Uint8Array(xhr.response)}),readAsync=(url,onload,onerror)=>{var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="arraybuffer",xhr.onload=()=>{if(xhr.status==200||xhr.status==0&&xhr.response){onload(xhr.response);return}onerror()},xhr.onerror=onerror,xhr.send(null)});var out=Module2.print||console.log.bind(console),err=Module2.printErr||console.error.bind(console);Object.assign(Module2,moduleOverrides),moduleOverrides=null,Module2.arguments&&(arguments_=Module2.arguments),Module2.thisProgram&&(thisProgram=Module2.thisProgram),Module2.quit&&(quit_=Module2.quit);var wasmBinary;Module2.wasmBinary&&(wasmBinary=Module2.wasmBinary),typeof WebAssembly!="object"&&abort("no native wasm support detected");var wasmMemory,ABORT=!1,EXITSTATUS,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var b=wasmMemory.buffer;Module2.HEAP8=HEAP8=new Int8Array(b),Module2.HEAP16=HEAP16=new Int16Array(b),Module2.HEAPU8=HEAPU8=new Uint8Array(b),Module2.HEAPU16=HEAPU16=new Uint16Array(b),Module2.HEAP32=HEAP32=new Int32Array(b),Module2.HEAPU32=HEAPU32=new Uint32Array(b),Module2.HEAPF32=HEAPF32=new Float32Array(b),Module2.HEAPF64=HEAPF64=new Float64Array(b)}var __ATPRERUN__=[],__ATINIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1;function preRun(){if(Module2.preRun)for(typeof Module2.preRun=="function"&&(Module2.preRun=[Module2.preRun]);Module2.preRun.length;)addOnPreRun(Module2.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__)}function postRun(){if(Module2.postRun)for(typeof Module2.postRun=="function"&&(Module2.postRun=[Module2.postRun]);Module2.postRun.length;)addOnPostRun(Module2.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(cb){__ATPRERUN__.unshift(cb)}function addOnInit(cb){__ATINIT__.unshift(cb)}function addOnPostRun(cb){__ATPOSTRUN__.unshift(cb)}var runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function addRunDependency(id){runDependencies++,Module2.monitorRunDependencies?.(runDependencies)}function removeRunDependency(id){if(runDependencies--,Module2.monitorRunDependencies?.(runDependencies),runDependencies==0&&(runDependencyWatcher!==null&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var callback=dependenciesFulfilled;dependenciesFulfilled=null,callback()}}function abort(what){Module2.onAbort?.(what),what="Aborted("+what+")",err(what),ABORT=!0,EXITSTATUS=1,what+=". Build with -sASSERTIONS for more info.";var e=new WebAssembly.RuntimeError(what);throw readyPromiseReject(e),e}var dataURIPrefix="data:application/octet-stream;base64,",isDataURI=filename=>filename.startsWith(dataURIPrefix),isFileURI=filename=>filename.startsWith("file://"),wasmBinaryFile;Module2.locateFile?(wasmBinaryFile="silk_wasm.wasm",isDataURI(wasmBinaryFile)||(wasmBinaryFile=locateFile(wasmBinaryFile))):wasmBinaryFile=new URL("silk_wasm.wasm",import.meta.url).href;function getBinarySync(file){if(file==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(file);throw"both async and sync fetching of the wasm failed"}function getBinaryPromise(binaryFile){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch=="function"&&!isFileURI(binaryFile))return fetch(binaryFile,{credentials:"same-origin"}).then(response=>{if(!response.ok)throw"failed to load wasm binary file at '"+binaryFile+"'";return response.arrayBuffer()}).catch(()=>getBinarySync(binaryFile));if(readAsync)return new Promise((resolve,reject)=>{readAsync(binaryFile,response=>resolve(new Uint8Array(response)),reject)})}return Promise.resolve().then(()=>getBinarySync(binaryFile))}function instantiateArrayBuffer(binaryFile,imports,receiver){return getBinaryPromise(binaryFile).then(binary=>WebAssembly.instantiate(binary,imports)).then(instance=>instance).then(receiver,reason=>{err(`failed to asynchronously prepare wasm: ${reason}`),abort(reason)})}function instantiateAsync(binary,binaryFile,imports,callback){return!binary&&typeof WebAssembly.instantiateStreaming=="function"&&!isDataURI(binaryFile)&&!isFileURI(binaryFile)&&!ENVIRONMENT_IS_NODE&&typeof fetch=="function"?fetch(binaryFile,{credentials:"same-origin"}).then(response=>{var result=WebAssembly.instantiateStreaming(response,imports);return result.then(callback,function(reason){return err(`wasm streaming compile failed: ${reason}`),err("falling back to ArrayBuffer instantiation"),instantiateArrayBuffer(binaryFile,imports,callback)})}):instantiateArrayBuffer(binaryFile,imports,callback)}function createWasm(){var info={a:wasmImports};function receiveInstance(instance,module){return wasmExports=instance.exports,wasmMemory=wasmExports.u,updateMemoryViews(),wasmTable=wasmExports.w,addOnInit(wasmExports.v),removeRunDependency("wasm-instantiate"),wasmExports}addRunDependency("wasm-instantiate");function receiveInstantiationResult(result){receiveInstance(result.instance)}if(Module2.instantiateWasm)try{return Module2.instantiateWasm(info,receiveInstance)}catch(e){err(`Module.instantiateWasm callback failed with error: ${e}`),readyPromiseReject(e)}return instantiateAsync(wasmBinary,wasmBinaryFile,info,receiveInstantiationResult).catch(readyPromiseReject),{}}function ExitStatus(status){this.name="ExitStatus",this.message=`Program terminated with exit(${status})`,this.status=status}var callRuntimeCallbacks=callbacks=>{for(;callbacks.length>0;)callbacks.shift()(Module2)},noExitRuntime=Module2.noExitRuntime||!0;class ExceptionInfo{constructor(excPtr){this.excPtr=excPtr,this.ptr=excPtr-24}set_type(type){HEAPU32[this.ptr+4>>2]=type}get_type(){return HEAPU32[this.ptr+4>>2]}set_destructor(destructor){HEAPU32[this.ptr+8>>2]=destructor}get_destructor(){return HEAPU32[this.ptr+8>>2]}set_caught(caught){caught=caught?1:0,HEAP8[this.ptr+12>>0]=caught}get_caught(){return HEAP8[this.ptr+12>>0]!=0}set_rethrown(rethrown){rethrown=rethrown?1:0,HEAP8[this.ptr+13>>0]=rethrown}get_rethrown(){return HEAP8[this.ptr+13>>0]!=0}init(type,destructor){this.set_adjusted_ptr(0),this.set_type(type),this.set_destructor(destructor)}set_adjusted_ptr(adjustedPtr){HEAPU32[this.ptr+16>>2]=adjustedPtr}get_adjusted_ptr(){return HEAPU32[this.ptr+16>>2]}get_exception_ptr(){var isPointer=___cxa_is_pointer_type(this.get_type());if(isPointer)return HEAPU32[this.excPtr>>2];var adjusted=this.get_adjusted_ptr();return adjusted!==0?adjusted:this.excPtr}}var exceptionLast=0,uncaughtExceptionCount=0,___cxa_throw=(ptr,type,destructor)=>{var info=new ExceptionInfo(ptr);throw info.init(type,destructor),exceptionLast=ptr,uncaughtExceptionCount++,exceptionLast},__embind_register_bigint=(primitiveType,name,size,minRange,maxRange)=>{},embind_init_charCodes=()=>{for(var codes=new Array(256),i=0;i<256;++i)codes[i]=String.fromCharCode(i);embind_charCodes=codes},embind_charCodes,readLatin1String=ptr=>{for(var ret="",c=ptr;HEAPU8[c];)ret+=embind_charCodes[HEAPU8[c++]];return ret},awaitingDependencies={},registeredTypes={},typeDependencies={},BindingError,throwBindingError=message=>{throw new BindingError(message)},InternalError,throwInternalError=message=>{throw new InternalError(message)},whenDependentTypesAreResolved=(myTypes,dependentTypes,getTypeConverters)=>{myTypes.forEach(function(type){typeDependencies[type]=dependentTypes});function onComplete(typeConverters2){var myTypeConverters=getTypeConverters(typeConverters2);myTypeConverters.length!==myTypes.length&&throwInternalError("Mismatched type converter count");for(var i=0;i<myTypes.length;++i)registerType(myTypes[i],myTypeConverters[i])}var typeConverters=new Array(dependentTypes.length),unregisteredTypes=[],registered=0;dependentTypes.forEach((dt,i)=>{registeredTypes.hasOwnProperty(dt)?typeConverters[i]=registeredTypes[dt]:(unregisteredTypes.push(dt),awaitingDependencies.hasOwnProperty(dt)||(awaitingDependencies[dt]=[]),awaitingDependencies[dt].push(()=>{typeConverters[i]=registeredTypes[dt],++registered,registered===unregisteredTypes.length&&onComplete(typeConverters)}))}),unregisteredTypes.length===0&&onComplete(typeConverters)};function sharedRegisterType(rawType,registeredInstance,options={}){var name=registeredInstance.name;if(rawType||throwBindingError(`type "${name}" must have a positive integer typeid pointer`),registeredTypes.hasOwnProperty(rawType)){if(options.ignoreDuplicateRegistrations)return;throwBindingError(`Cannot register type '${name}' twice`)}if(registeredTypes[rawType]=registeredInstance,delete typeDependencies[rawType],awaitingDependencies.hasOwnProperty(rawType)){var callbacks=awaitingDependencies[rawType];delete awaitingDependencies[rawType],callbacks.forEach(cb=>cb())}}function registerType(rawType,registeredInstance,options={}){if(!("argPackAdvance"in registeredInstance))throw new TypeError("registerType registeredInstance requires argPackAdvance");return sharedRegisterType(rawType,registeredInstance,options)}var GenericWireTypeSize=8,__embind_register_bool=(rawType,name,trueValue,falseValue)=>{name=readLatin1String(name),registerType(rawType,{name,fromWireType:function(wt){return!!wt},toWireType:function(destructors,o){return o?trueValue:falseValue},argPackAdvance:GenericWireTypeSize,readValueFromPointer:function(pointer){return this.fromWireType(HEAPU8[pointer])},destructorFunction:null})};class HandleAllocator{constructor(){this.allocated=[void 0],this.freelist=[]}get(id){return this.allocated[id]}has(id){return this.allocated[id]!==void 0}allocate(handle){var id=this.freelist.pop()||this.allocated.length;return this.allocated[id]=handle,id}free(id){this.allocated[id]=void 0,this.freelist.push(id)}}var emval_handles=new HandleAllocator,__emval_decref=handle=>{handle>=emval_handles.reserved&&--emval_handles.get(handle).refcount===0&&emval_handles.free(handle)},count_emval_handles=()=>{for(var count=0,i=emval_handles.reserved;i<emval_handles.allocated.length;++i)emval_handles.allocated[i]!==void 0&&++count;return count},init_emval=()=>{emval_handles.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),Object.assign(emval_handles,{reserved:emval_handles.allocated.length}),Module2.count_emval_handles=count_emval_handles},Emval={toValue:handle=>(handle||throwBindingError("Cannot use deleted val. handle = "+handle),emval_handles.get(handle).value),toHandle:value=>{switch(value){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return emval_handles.allocate({refcount:1,value})}}};function simpleReadValueFromPointer(pointer){return this.fromWireType(HEAP32[pointer>>2])}var EmValType={name:"emscripten::val",fromWireType:handle=>{var rv=Emval.toValue(handle);return __emval_decref(handle),rv},toWireType:(destructors,value)=>Emval.toHandle(value),argPackAdvance:GenericWireTypeSize,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:null},__embind_register_emval=rawType=>registerType(rawType,EmValType),floatReadValueFromPointer=(name,width)=>{switch(width){case 4:return function(pointer){return this.fromWireType(HEAPF32[pointer>>2])};case 8:return function(pointer){return this.fromWireType(HEAPF64[pointer>>3])};default:throw new TypeError(`invalid float width (${width}): ${name}`)}},__embind_register_float=(rawType,name,size)=>{name=readLatin1String(name),registerType(rawType,{name,fromWireType:value=>value,toWireType:(destructors,value)=>value,argPackAdvance:GenericWireTypeSize,readValueFromPointer:floatReadValueFromPointer(name,size),destructorFunction:null})},createNamedFunction=(name,body)=>Object.defineProperty(body,"name",{value:name}),runDestructors=destructors=>{for(;destructors.length;){var ptr=destructors.pop(),del=destructors.pop();del(ptr)}};function usesDestructorStack(argTypes){for(var i=1;i<argTypes.length;++i)if(argTypes[i]!==null&&argTypes[i].destructorFunction===void 0)return!0;return!1}function newFunc(constructor,argumentList){if(!(constructor instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof constructor} which is not a function`);var dummy=createNamedFunction(constructor.name||"unknownFunctionName",function(){});dummy.prototype=constructor.prototype;var obj=new dummy,r=constructor.apply(obj,argumentList);return r instanceof Object?r:obj}function createJsInvoker(humanName,argTypes,isClassMethodFunc,returns,isAsync){for(var needsDestructorStack=usesDestructorStack(argTypes),argCount=argTypes.length,argsList="",argsListWired="",i=0;i<argCount-2;++i)argsList+=(i!==0?", ":"")+"arg"+i,argsListWired+=(i!==0?", ":"")+"arg"+i+"Wired";var invokerFnBody=`
        return function (${argsList}) {
        if (arguments.length !== ${argCount-2}) {
          throwBindingError('function ${humanName} called with ' + arguments.length + ' arguments, expected ${argCount-2}');
        }`;needsDestructorStack&&(invokerFnBody+=`var destructors = [];
`);var dtorStack=needsDestructorStack?"destructors":"null",args1=["throwBindingError","invoker","fn","runDestructors","retType","classParam"];isClassMethodFunc&&(invokerFnBody+="var thisWired = classParam['toWireType']("+dtorStack+`, this);
`);for(var i=0;i<argCount-2;++i)invokerFnBody+="var arg"+i+"Wired = argType"+i+"['toWireType']("+dtorStack+", arg"+i+"); // "+argTypes[i+2].name+`
`,args1.push("argType"+i);if(isClassMethodFunc&&(argsListWired="thisWired"+(argsListWired.length>0?", ":"")+argsListWired),invokerFnBody+=(returns||isAsync?"var rv = ":"")+"invoker(fn"+(argsListWired.length>0?", ":"")+argsListWired+`);
`,needsDestructorStack)invokerFnBody+=`runDestructors(destructors);
`;else for(var i=isClassMethodFunc?1:2;i<argTypes.length;++i){var paramName=i===1?"thisWired":"arg"+(i-2)+"Wired";argTypes[i].destructorFunction!==null&&(invokerFnBody+=paramName+"_dtor("+paramName+"); // "+argTypes[i].name+`
`,args1.push(paramName+"_dtor"))}return returns&&(invokerFnBody+=`var ret = retType['fromWireType'](rv);
return ret;
`),invokerFnBody+=`}
`,[args1,invokerFnBody]}function craftInvokerFunction(humanName,argTypes,classType,cppInvokerFunc,cppTargetFunc,isAsync){var argCount=argTypes.length;argCount<2&&throwBindingError("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var isClassMethodFunc=argTypes[1]!==null&&classType!==null,needsDestructorStack=usesDestructorStack(argTypes),returns=argTypes[0].name!=="void",closureArgs=[throwBindingError,cppInvokerFunc,cppTargetFunc,runDestructors,argTypes[0],argTypes[1]],i=0;i<argCount-2;++i)closureArgs.push(argTypes[i+2]);if(!needsDestructorStack)for(var i=isClassMethodFunc?1:2;i<argTypes.length;++i)argTypes[i].destructorFunction!==null&&closureArgs.push(argTypes[i].destructorFunction);let[args,invokerFnBody]=createJsInvoker(humanName,argTypes,isClassMethodFunc,returns,isAsync);args.push(invokerFnBody);var invokerFn=newFunc(Function,args).apply(null,closureArgs);return createNamedFunction(humanName,invokerFn)}var ensureOverloadTable=(proto,methodName,humanName)=>{if(proto[methodName].overloadTable===void 0){var prevFunc=proto[methodName];proto[methodName]=function(){return proto[methodName].overloadTable.hasOwnProperty(arguments.length)||throwBindingError(`Function '${humanName}' called with an invalid number of arguments (${arguments.length}) - expects one of (${proto[methodName].overloadTable})!`),proto[methodName].overloadTable[arguments.length].apply(this,arguments)},proto[methodName].overloadTable=[],proto[methodName].overloadTable[prevFunc.argCount]=prevFunc}},exposePublicSymbol=(name,value,numArguments)=>{Module2.hasOwnProperty(name)?((numArguments===void 0||Module2[name].overloadTable!==void 0&&Module2[name].overloadTable[numArguments]!==void 0)&&throwBindingError(`Cannot register public name '${name}' twice`),ensureOverloadTable(Module2,name,name),Module2.hasOwnProperty(numArguments)&&throwBindingError(`Cannot register multiple overloads of a function with the same number of arguments (${numArguments})!`),Module2[name].overloadTable[numArguments]=value):(Module2[name]=value,numArguments!==void 0&&(Module2[name].numArguments=numArguments))},heap32VectorToArray=(count,firstElement)=>{for(var array=[],i=0;i<count;i++)array.push(HEAPU32[firstElement+i*4>>2]);return array},replacePublicSymbol=(name,value,numArguments)=>{Module2.hasOwnProperty(name)||throwInternalError("Replacing nonexistant public symbol"),Module2[name].overloadTable!==void 0&&numArguments!==void 0?Module2[name].overloadTable[numArguments]=value:(Module2[name]=value,Module2[name].argCount=numArguments)},dynCallLegacy=(sig,ptr,args)=>{var f=Module2["dynCall_"+sig];return args&&args.length?f.apply(null,[ptr].concat(args)):f.call(null,ptr)},wasmTableMirror=[],wasmTable,getWasmTableEntry=funcPtr=>{var func=wasmTableMirror[funcPtr];return func||(funcPtr>=wasmTableMirror.length&&(wasmTableMirror.length=funcPtr+1),wasmTableMirror[funcPtr]=func=wasmTable.get(funcPtr)),func},dynCall=(sig,ptr,args)=>{if(sig.includes("j"))return dynCallLegacy(sig,ptr,args);var rtn=getWasmTableEntry(ptr).apply(null,args);return rtn},getDynCaller=(sig,ptr)=>{var argCache=[];return function(){return argCache.length=0,Object.assign(argCache,arguments),dynCall(sig,ptr,argCache)}},embind__requireFunction=(signature,rawFunction)=>{signature=readLatin1String(signature);function makeDynCaller(){return signature.includes("j")?getDynCaller(signature,rawFunction):getWasmTableEntry(rawFunction)}var fp=makeDynCaller();return typeof fp!="function"&&throwBindingError(`unknown function pointer with signature ${signature}: ${rawFunction}`),fp},extendError=(baseErrorType,errorName)=>{var errorClass=createNamedFunction(errorName,function(message){this.name=errorName,this.message=message;var stack=new Error(message).stack;stack!==void 0&&(this.stack=this.toString()+`
`+stack.replace(/^Error(:[^\n]*)?\n/,""))});return errorClass.prototype=Object.create(baseErrorType.prototype),errorClass.prototype.constructor=errorClass,errorClass.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},errorClass},UnboundTypeError,getTypeName=type=>{var ptr=___getTypeName(type),rv=readLatin1String(ptr);return _free(ptr),rv},throwUnboundTypeError=(message,types)=>{var unboundTypes=[],seen={};function visit(type){if(!seen[type]&&!registeredTypes[type]){if(typeDependencies[type]){typeDependencies[type].forEach(visit);return}unboundTypes.push(type),seen[type]=!0}}throw types.forEach(visit),new UnboundTypeError(`${message}: `+unboundTypes.map(getTypeName).join([", "]))},getFunctionName=signature=>{signature=signature.trim();let argsIndex=signature.indexOf("(");return argsIndex!==-1?signature.substr(0,argsIndex):signature},__embind_register_function=(name,argCount,rawArgTypesAddr,signature,rawInvoker,fn,isAsync)=>{var argTypes=heap32VectorToArray(argCount,rawArgTypesAddr);name=readLatin1String(name),name=getFunctionName(name),rawInvoker=embind__requireFunction(signature,rawInvoker),exposePublicSymbol(name,function(){throwUnboundTypeError(`Cannot call ${name} due to unbound types`,argTypes)},argCount-1),whenDependentTypesAreResolved([],argTypes,function(argTypes2){var invokerArgsArray=[argTypes2[0],null].concat(argTypes2.slice(1));return replacePublicSymbol(name,craftInvokerFunction(name,invokerArgsArray,null,rawInvoker,fn,isAsync),argCount-1),[]})},integerReadValueFromPointer=(name,width,signed)=>{switch(width){case 1:return signed?pointer=>HEAP8[pointer>>0]:pointer=>HEAPU8[pointer>>0];case 2:return signed?pointer=>HEAP16[pointer>>1]:pointer=>HEAPU16[pointer>>1];case 4:return signed?pointer=>HEAP32[pointer>>2]:pointer=>HEAPU32[pointer>>2];default:throw new TypeError(`invalid integer width (${width}): ${name}`)}},__embind_register_integer=(primitiveType,name,size,minRange,maxRange)=>{name=readLatin1String(name),maxRange===-1&&(maxRange=4294967295);var fromWireType=value=>value;if(minRange===0){var bitshift=32-8*size;fromWireType=value=>value<<bitshift>>>bitshift}var isUnsignedType=name.includes("unsigned"),checkAssertions=(value,toTypeName)=>{},toWireType;isUnsignedType?toWireType=function(destructors,value){return checkAssertions(value,this.name),value>>>0}:toWireType=function(destructors,value){return checkAssertions(value,this.name),value},registerType(primitiveType,{name,fromWireType,toWireType,argPackAdvance:GenericWireTypeSize,readValueFromPointer:integerReadValueFromPointer(name,size,minRange!==0),destructorFunction:null})},__embind_register_memory_view=(rawType,dataTypeIndex,name)=>{var typeMapping=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],TA=typeMapping[dataTypeIndex];function decodeMemoryView(handle){var size=HEAPU32[handle>>2],data=HEAPU32[handle+4>>2];return new TA(HEAP8.buffer,data,size)}name=readLatin1String(name),registerType(rawType,{name,fromWireType:decodeMemoryView,argPackAdvance:GenericWireTypeSize,readValueFromPointer:decodeMemoryView},{ignoreDuplicateRegistrations:!0})};function readPointer(pointer){return this.fromWireType(HEAPU32[pointer>>2])}var stringToUTF8Array=(str,heap,outIdx,maxBytesToWrite)=>{if(!(maxBytesToWrite>0))return 0;for(var startIdx=outIdx,endIdx=outIdx+maxBytesToWrite-1,i=0;i<str.length;++i){var u=str.charCodeAt(i);if(u>=55296&&u<=57343){var u1=str.charCodeAt(++i);u=65536+((u&1023)<<10)|u1&1023}if(u<=127){if(outIdx>=endIdx)break;heap[outIdx++]=u}else if(u<=2047){if(outIdx+1>=endIdx)break;heap[outIdx++]=192|u>>6,heap[outIdx++]=128|u&63}else if(u<=65535){if(outIdx+2>=endIdx)break;heap[outIdx++]=224|u>>12,heap[outIdx++]=128|u>>6&63,heap[outIdx++]=128|u&63}else{if(outIdx+3>=endIdx)break;heap[outIdx++]=240|u>>18,heap[outIdx++]=128|u>>12&63,heap[outIdx++]=128|u>>6&63,heap[outIdx++]=128|u&63}}return heap[outIdx]=0,outIdx-startIdx},stringToUTF8=(str,outPtr,maxBytesToWrite)=>stringToUTF8Array(str,HEAPU8,outPtr,maxBytesToWrite),lengthBytesUTF8=str=>{for(var len=0,i=0;i<str.length;++i){var c=str.charCodeAt(i);c<=127?len++:c<=2047?len+=2:c>=55296&&c<=57343?(len+=4,++i):len+=3}return len},UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,UTF8ArrayToString=(heapOrArray,idx,maxBytesToRead)=>{for(var endIdx=idx+maxBytesToRead,endPtr=idx;heapOrArray[endPtr]&&!(endPtr>=endIdx);)++endPtr;if(endPtr-idx>16&&heapOrArray.buffer&&UTF8Decoder)return UTF8Decoder.decode(heapOrArray.subarray(idx,endPtr));for(var str="";idx<endPtr;){var u0=heapOrArray[idx++];if(!(u0&128)){str+=String.fromCharCode(u0);continue}var u1=heapOrArray[idx++]&63;if((u0&224)==192){str+=String.fromCharCode((u0&31)<<6|u1);continue}var u2=heapOrArray[idx++]&63;if((u0&240)==224?u0=(u0&15)<<12|u1<<6|u2:u0=(u0&7)<<18|u1<<12|u2<<6|heapOrArray[idx++]&63,u0<65536)str+=String.fromCharCode(u0);else{var ch=u0-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023)}}return str},UTF8ToString=(ptr,maxBytesToRead)=>ptr?UTF8ArrayToString(HEAPU8,ptr,maxBytesToRead):"",__embind_register_std_string=(rawType,name)=>{name=readLatin1String(name);var stdStringIsUTF8=name==="std::string";registerType(rawType,{name,fromWireType(value){var length=HEAPU32[value>>2],payload=value+4,str;if(stdStringIsUTF8)for(var decodeStartPtr=payload,i=0;i<=length;++i){var currentBytePtr=payload+i;if(i==length||HEAPU8[currentBytePtr]==0){var maxRead=currentBytePtr-decodeStartPtr,stringSegment=UTF8ToString(decodeStartPtr,maxRead);str===void 0?str=stringSegment:(str+="\0",str+=stringSegment),decodeStartPtr=currentBytePtr+1}}else{for(var a=new Array(length),i=0;i<length;++i)a[i]=String.fromCharCode(HEAPU8[payload+i]);str=a.join("")}return _free(value),str},toWireType(destructors,value){value instanceof ArrayBuffer&&(value=new Uint8Array(value));var length,valueIsOfTypeString=typeof value=="string";valueIsOfTypeString||value instanceof Uint8Array||value instanceof Uint8ClampedArray||value instanceof Int8Array||throwBindingError("Cannot pass non-string to std::string"),stdStringIsUTF8&&valueIsOfTypeString?length=lengthBytesUTF8(value):length=value.length;var base=_malloc(4+length+1),ptr=base+4;if(HEAPU32[base>>2]=length,stdStringIsUTF8&&valueIsOfTypeString)stringToUTF8(value,ptr,length+1);else if(valueIsOfTypeString)for(var i=0;i<length;++i){var charCode=value.charCodeAt(i);charCode>255&&(_free(ptr),throwBindingError("String has UTF-16 code units that do not fit in 8 bits")),HEAPU8[ptr+i]=charCode}else for(var i=0;i<length;++i)HEAPU8[ptr+i]=value[i];return destructors!==null&&destructors.push(_free,base),base},argPackAdvance:GenericWireTypeSize,readValueFromPointer:readPointer,destructorFunction(ptr){_free(ptr)}})},UTF16Decoder=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,UTF16ToString=(ptr,maxBytesToRead)=>{for(var endPtr=ptr,idx=endPtr>>1,maxIdx=idx+maxBytesToRead/2;!(idx>=maxIdx)&&HEAPU16[idx];)++idx;if(endPtr=idx<<1,endPtr-ptr>32&&UTF16Decoder)return UTF16Decoder.decode(HEAPU8.subarray(ptr,endPtr));for(var str="",i=0;!(i>=maxBytesToRead/2);++i){var codeUnit=HEAP16[ptr+i*2>>1];if(codeUnit==0)break;str+=String.fromCharCode(codeUnit)}return str},stringToUTF16=(str,outPtr,maxBytesToWrite)=>{if(maxBytesToWrite??=2147483647,maxBytesToWrite<2)return 0;maxBytesToWrite-=2;for(var startPtr=outPtr,numCharsToWrite=maxBytesToWrite<str.length*2?maxBytesToWrite/2:str.length,i=0;i<numCharsToWrite;++i){var codeUnit=str.charCodeAt(i);HEAP16[outPtr>>1]=codeUnit,outPtr+=2}return HEAP16[outPtr>>1]=0,outPtr-startPtr},lengthBytesUTF16=str=>str.length*2,UTF32ToString=(ptr,maxBytesToRead)=>{for(var i=0,str="";!(i>=maxBytesToRead/4);){var utf32=HEAP32[ptr+i*4>>2];if(utf32==0)break;if(++i,utf32>=65536){var ch=utf32-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023)}else str+=String.fromCharCode(utf32)}return str},stringToUTF32=(str,outPtr,maxBytesToWrite)=>{if(maxBytesToWrite??=2147483647,maxBytesToWrite<4)return 0;for(var startPtr=outPtr,endPtr=startPtr+maxBytesToWrite-4,i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343){var trailSurrogate=str.charCodeAt(++i);codeUnit=65536+((codeUnit&1023)<<10)|trailSurrogate&1023}if(HEAP32[outPtr>>2]=codeUnit,outPtr+=4,outPtr+4>endPtr)break}return HEAP32[outPtr>>2]=0,outPtr-startPtr},lengthBytesUTF32=str=>{for(var len=0,i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);codeUnit>=55296&&codeUnit<=57343&&++i,len+=4}return len},__embind_register_std_wstring=(rawType,charSize,name)=>{name=readLatin1String(name);var decodeString,encodeString,getHeap,lengthBytesUTF,shift;charSize===2?(decodeString=UTF16ToString,encodeString=stringToUTF16,lengthBytesUTF=lengthBytesUTF16,getHeap=()=>HEAPU16,shift=1):charSize===4&&(decodeString=UTF32ToString,encodeString=stringToUTF32,lengthBytesUTF=lengthBytesUTF32,getHeap=()=>HEAPU32,shift=2),registerType(rawType,{name,fromWireType:value=>{for(var length=HEAPU32[value>>2],HEAP=getHeap(),str,decodeStartPtr=value+4,i=0;i<=length;++i){var currentBytePtr=value+4+i*charSize;if(i==length||HEAP[currentBytePtr>>shift]==0){var maxReadBytes=currentBytePtr-decodeStartPtr,stringSegment=decodeString(decodeStartPtr,maxReadBytes);str===void 0?str=stringSegment:(str+="\0",str+=stringSegment),decodeStartPtr=currentBytePtr+charSize}}return _free(value),str},toWireType:(destructors,value)=>{typeof value!="string"&&throwBindingError(`Cannot pass non-string to C++ string type ${name}`);var length=lengthBytesUTF(value),ptr=_malloc(4+length+charSize);return HEAPU32[ptr>>2]=length>>shift,encodeString(value,ptr+4,length+charSize),destructors!==null&&destructors.push(_free,ptr),ptr},argPackAdvance:GenericWireTypeSize,readValueFromPointer:simpleReadValueFromPointer,destructorFunction(ptr){_free(ptr)}})},__embind_register_void=(rawType,name)=>{name=readLatin1String(name),registerType(rawType,{isVoid:!0,name,argPackAdvance:0,fromWireType:()=>{},toWireType:(destructors,o)=>{}})},emval_methodCallers=[],__emval_call=(caller,handle,destructorsRef,args)=>(caller=emval_methodCallers[caller],handle=Emval.toValue(handle),caller(null,handle,destructorsRef,args)),emval_addMethodCaller=caller=>{var id=emval_methodCallers.length;return emval_methodCallers.push(caller),id},requireRegisteredType=(rawType,humanName)=>{var impl=registeredTypes[rawType];return impl===void 0&&throwBindingError(humanName+" has unknown type "+getTypeName(rawType)),impl},emval_lookupTypes=(argCount,argTypes)=>{for(var a=new Array(argCount),i=0;i<argCount;++i)a[i]=requireRegisteredType(HEAPU32[argTypes+i*4>>2],"parameter "+i);return a},reflectConstruct=Reflect.construct,emval_returnValue=(returnType,destructorsRef,handle)=>{var destructors=[],result=returnType.toWireType(destructors,handle);return destructors.length&&(HEAPU32[destructorsRef>>2]=Emval.toHandle(destructors)),result},__emval_get_method_caller=(argCount,argTypes,kind)=>{var types=emval_lookupTypes(argCount,argTypes),retType=types.shift();argCount--;var functionBody=`return function (obj, func, destructorsRef, args) {
`,offset=0,argsList=[];kind===0&&argsList.push("obj");for(var params=["retType"],args=[retType],i=0;i<argCount;++i)argsList.push("arg"+i),params.push("argType"+i),args.push(types[i]),functionBody+=`  var arg${i} = argType${i}.readValueFromPointer(args${offset?"+"+offset:""});
`,offset+=types[i].argPackAdvance;var invoker=kind===1?"new func":"func.call";functionBody+=`  var rv = ${invoker}(${argsList.join(", ")});
`,retType.isVoid||(params.push("emval_returnValue"),args.push(emval_returnValue),functionBody+=`  return emval_returnValue(retType, destructorsRef, rv);
`),functionBody+=`};
`,params.push(functionBody);var invokerFunction=newFunc(Function,params).apply(null,args),functionName=`methodCaller<(${types.map(t=>t.name).join(", ")}) => ${retType.name}>`;return emval_addMethodCaller(createNamedFunction(functionName,invokerFunction))},__emval_incref=handle=>{handle>4&&(emval_handles.get(handle).refcount+=1)},__emval_run_destructors=handle=>{var destructors=Emval.toValue(handle);runDestructors(destructors),__emval_decref(handle)},__emval_take_value=(type,arg)=>{type=requireRegisteredType(type,"_emval_take_value");var v=type.readValueFromPointer(arg);return Emval.toHandle(v)},_abort=()=>{abort("")},_emscripten_memcpy_js=(dest,src,num)=>HEAPU8.copyWithin(dest,src,src+num),getHeapMax=()=>2147483648,growMemory=size=>{var b=wasmMemory.buffer,pages=(size-b.byteLength+65535)/65536;try{return wasmMemory.grow(pages),updateMemoryViews(),1}catch{}},_emscripten_resize_heap=requestedSize=>{var oldSize=HEAPU8.length;requestedSize>>>=0;var maxHeapSize=getHeapMax();if(requestedSize>maxHeapSize)return!1;for(var alignUp=(x,multiple)=>x+(multiple-x%multiple)%multiple,cutDown=1;cutDown<=4;cutDown*=2){var overGrownHeapSize=oldSize*(1+.2/cutDown);overGrownHeapSize=Math.min(overGrownHeapSize,requestedSize+100663296);var newSize=Math.min(maxHeapSize,alignUp(Math.max(requestedSize,overGrownHeapSize),65536)),replacement=growMemory(newSize);if(replacement)return!0}return!1};embind_init_charCodes(),BindingError=Module2.BindingError=class extends Error{constructor(message){super(message),this.name="BindingError"}},InternalError=Module2.InternalError=class extends Error{constructor(message){super(message),this.name="InternalError"}},init_emval(),UnboundTypeError=Module2.UnboundTypeError=extendError(Error,"UnboundTypeError");var wasmImports={k:___cxa_throw,o:__embind_register_bigint,i:__embind_register_bool,s:__embind_register_emval,h:__embind_register_float,d:__embind_register_function,b:__embind_register_integer,a:__embind_register_memory_view,g:__embind_register_std_string,f:__embind_register_std_wstring,j:__embind_register_void,m:__emval_call,c:__emval_decref,n:__emval_get_method_caller,e:__emval_incref,l:__emval_run_destructors,t:__emval_take_value,p:_abort,r:_emscripten_memcpy_js,q:_emscripten_resize_heap},wasmExports=createWasm(),___wasm_call_ctors=()=>(___wasm_call_ctors=wasmExports.v)(),_malloc=a0=>(_malloc=wasmExports.x)(a0),_free=a0=>(_free=wasmExports.y)(a0),___getTypeName=a0=>(___getTypeName=wasmExports.z)(a0),___cxa_is_pointer_type=a0=>(___cxa_is_pointer_type=wasmExports.A)(a0),calledRun;dependenciesFulfilled=function runCaller(){calledRun||run(),calledRun||(dependenciesFulfilled=runCaller)};function run(){if(runDependencies>0||(preRun(),runDependencies>0))return;function doRun(){calledRun||(calledRun=!0,Module2.calledRun=!0,!ABORT&&(initRuntime(),readyPromiseResolve(Module2),Module2.onRuntimeInitialized&&Module2.onRuntimeInitialized(),postRun()))}Module2.setStatus?(Module2.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module2.setStatus("")},1),doRun()},1)):doRun()}if(Module2.preInit)for(typeof Module2.preInit=="function"&&(Module2.preInit=[Module2.preInit]);Module2.preInit.length>0;)Module2.preInit.pop()();return run(),moduleArg.ready}})(),silk_wasm_default=Module;function isWavFile(fileData){try{let chunks=unpackWavFileChunks(fileData),fmt=decodeFormatChunk(chunks.get("fmt")),data=chunks.get("data");return getWavFileType(fmt),verifyDataChunkLength(data,fmt),!0}catch{return!1}}var audioEncodingNames=["int","float"],wavFileTypeAudioEncodings=[0,0,0,1];function decodeWavFile(fileData){let chunks=unpackWavFileChunks(fileData),fmt=decodeFormatChunk(chunks.get("fmt")),data=chunks.get("data"),wavFileType=getWavFileType(fmt),audioEncoding=wavFileTypeAudioEncodings[wavFileType],wavFileTypeName=audioEncodingNames[audioEncoding]+fmt.bitsPerSample;return verifyDataChunkLength(data,fmt),{channelData:decodeDataChunk(data,fmt,wavFileType),sampleRate:fmt.sampleRate,numberOfChannels:fmt.numberOfChannels,audioEncoding,bitsPerSample:fmt.bitsPerSample,wavFileTypeName}}function unpackWavFileChunks(fileData){let dataView;fileData instanceof ArrayBuffer?dataView=new DataView(fileData):dataView=new DataView(fileData.buffer,fileData.byteOffset,fileData.byteLength);let fileLength=dataView.byteLength;if(fileLength<20)throw new Error("WAV file is too short.");if(getString(dataView,0,4)!="RIFF")throw new Error("Not a valid WAV file (no RIFF header).");let mainChunkLength=dataView.getUint32(4,!0);if(8+mainChunkLength!=fileLength)throw new Error(`Main chunk length of WAV file (${8+mainChunkLength}) does not match file size (${fileLength}).`);if(getString(dataView,8,4)!="WAVE")throw new Error("RIFF file is not a WAV file.");let chunks=new Map,fileOffset=12;for(;fileOffset<fileLength;){if(fileOffset+8>fileLength)throw new Error(`Incomplete chunk prefix in WAV file at offset ${fileOffset}.`);let chunkId=getString(dataView,fileOffset,4).trim(),chunkLength=dataView.getUint32(fileOffset+4,!0);if(fileOffset+8+chunkLength>fileLength)throw new Error(`Incomplete chunk data in WAV file at offset ${fileOffset}.`);let chunkData=new DataView(dataView.buffer,dataView.byteOffset+fileOffset+8,chunkLength);chunks.set(chunkId,chunkData);let padLength=chunkLength%2;fileOffset+=8+chunkLength+padLength}return chunks}function getString(dataView,offset,length){let a=new Uint8Array(dataView.buffer,dataView.byteOffset+offset,length);return String.fromCharCode.apply(null,a)}function getInt24(dataView,offset){let b0=dataView.getInt8(offset+2)*65536,b12=dataView.getUint16(offset,!0);return b0+b12}function decodeFormatChunk(dataView){if(!dataView)throw new Error("No format chunk found in WAV file.");if(dataView.byteLength<16)throw new Error("Format chunk of WAV file is too short.");let fmt={};return fmt.formatCode=dataView.getUint16(0,!0),fmt.numberOfChannels=dataView.getUint16(2,!0),fmt.sampleRate=dataView.getUint32(4,!0),fmt.bytesPerSec=dataView.getUint32(8,!0),fmt.bytesPerFrame=dataView.getUint16(12,!0),fmt.bitsPerSample=dataView.getUint16(14,!0),fmt}function getWavFileType(fmt){if(fmt.numberOfChannels<1||fmt.numberOfChannels>999)throw new Error("Invalid number of channels in WAV file.");let bytesPerSample=Math.ceil(fmt.bitsPerSample/8),expectedBytesPerFrame=fmt.numberOfChannels*bytesPerSample;if(fmt.formatCode==1&&fmt.bitsPerSample>=1&&fmt.bitsPerSample<=8&&fmt.bytesPerFrame==expectedBytesPerFrame)return 0;if(fmt.formatCode==1&&fmt.bitsPerSample>=9&&fmt.bitsPerSample<=16&&fmt.bytesPerFrame==expectedBytesPerFrame)return 1;if(fmt.formatCode==1&&fmt.bitsPerSample>=17&&fmt.bitsPerSample<=24&&fmt.bytesPerFrame==expectedBytesPerFrame)return 2;if(fmt.formatCode==3&&fmt.bitsPerSample==32&&fmt.bytesPerFrame==expectedBytesPerFrame)return 3;throw new Error(`Unsupported WAV file type, formatCode=${fmt.formatCode}, bitsPerSample=${fmt.bitsPerSample}, bytesPerFrame=${fmt.bytesPerFrame}, numberOfChannels=${fmt.numberOfChannels}.`)}function decodeDataChunk(data,fmt,wavFileType){switch(wavFileType){case 0:return decodeDataChunk_uint8(data,fmt);case 1:return decodeDataChunk_int16(data,fmt);case 2:return decodeDataChunk_int24(data,fmt);case 3:return decodeDataChunk_float32(data,fmt);default:throw new Error("No decoder.")}}function decodeDataChunk_int16(data,fmt){let channelData=allocateChannelDataArrays(data.byteLength,fmt),numberOfChannels=fmt.numberOfChannels,numberOfFrames=channelData[0].length,offs=0;for(let frameNo=0;frameNo<numberOfFrames;frameNo++)for(let channelNo=0;channelNo<numberOfChannels;channelNo++){let sampleValueFloat=data.getInt16(offs,!0)/32768;channelData[channelNo][frameNo]=sampleValueFloat,offs+=2}return channelData}function decodeDataChunk_uint8(data,fmt){let channelData=allocateChannelDataArrays(data.byteLength,fmt),numberOfChannels=fmt.numberOfChannels,numberOfFrames=channelData[0].length,offs=0;for(let frameNo=0;frameNo<numberOfFrames;frameNo++)for(let channelNo=0;channelNo<numberOfChannels;channelNo++){let sampleValueFloat=(data.getUint8(offs)-128)/128;channelData[channelNo][frameNo]=sampleValueFloat,offs+=1}return channelData}function decodeDataChunk_int24(data,fmt){let channelData=allocateChannelDataArrays(data.byteLength,fmt),numberOfChannels=fmt.numberOfChannels,numberOfFrames=channelData[0].length,offs=0;for(let frameNo=0;frameNo<numberOfFrames;frameNo++)for(let channelNo=0;channelNo<numberOfChannels;channelNo++){let sampleValueFloat=getInt24(data,offs)/8388608;channelData[channelNo][frameNo]=sampleValueFloat,offs+=3}return channelData}function decodeDataChunk_float32(data,fmt){let channelData=allocateChannelDataArrays(data.byteLength,fmt),numberOfChannels=fmt.numberOfChannels,numberOfFrames=channelData[0].length,offs=0;for(let frameNo=0;frameNo<numberOfFrames;frameNo++)for(let channelNo=0;channelNo<numberOfChannels;channelNo++){let sampleValueFloat=data.getFloat32(offs,!0);channelData[channelNo][frameNo]=sampleValueFloat,offs+=4}return channelData}function allocateChannelDataArrays(dataLength,fmt){let numberOfFrames=Math.floor(dataLength/fmt.bytesPerFrame),channelData=new Array(fmt.numberOfChannels);for(let channelNo=0;channelNo<fmt.numberOfChannels;channelNo++)channelData[channelNo]=new Float32Array(numberOfFrames);return channelData}function verifyDataChunkLength(data,fmt){if(!data)throw new Error("No data chunk found in WAV file.");if(data.byteLength%fmt.bytesPerFrame!=0)throw new Error("WAV file data chunk length is not a multiple of frame size.")}function concat(list,length){if(list.length===0)return new Uint8Array;if(length===void 0){length=0;for(let i=0;i<list.length;i++)list[i].length&&(length+=list[i].length)}let buffer=new Uint8Array(length),pos=0;for(let i=0;i<list.length;i++){let buf=list[i];pos+=_copyActual(buf,buffer,pos,0,buf.length)}return pos<length&&buffer.fill(0,pos,length),buffer}function _copyActual(source,target,targetStart,sourceStart,sourceEnd){sourceEnd-sourceStart>target.length-targetStart&&(sourceEnd=sourceStart+target.length-targetStart);let nb=sourceEnd-sourceStart,sourceLen=source.length-sourceStart;return nb>sourceLen&&(nb=sourceLen),(sourceStart!==0||sourceEnd<source.length)&&(source=new Uint8Array(source.buffer,source.byteOffset+sourceStart,nb)),target.set(source,targetStart),nb}function ensureMonoPcm(channelData){let{length:numberOfChannels}=channelData;if(numberOfChannels===1)return channelData[0];let monoData=new Float32Array(channelData[0].length);for(let i=0;i<monoData.length;i++){let sum=0;for(let j=0;j<numberOfChannels;j++)sum+=channelData[j][i];monoData[i]=sum/numberOfChannels}return monoData}function ensureS16lePcm(input){let numberOfFrames=input.length,bytesPerSample=Math.ceil(16/8),fileLength=numberOfFrames*bytesPerSample,arrayBuffer=new ArrayBuffer(fileLength),int16Array=new Int16Array(arrayBuffer);for(let offset=0;offset<numberOfFrames;offset++){let sampleValueFloat=input[offset],sampleValueInt16=floatToSignedInt16(sampleValueFloat);int16Array[offset]=sampleValueInt16}return arrayBuffer}function floatToSignedInt16(v){return v*=32768,v=~~v,v>32767?32767:v}async function encode(input,sampleRate){let instance=await silk_wasm_default(),buffer=ArrayBuffer.isView(input)?input.buffer:input;if(isWavFile(input)){let{channelData,sampleRate:wavSampleRate}=decodeWavFile(input);sampleRate||=wavSampleRate,buffer=ensureS16lePcm(ensureMonoPcm(channelData))}let arr=[],outputLength=0,ret=instance.silk_encode(buffer,buffer.byteLength,sampleRate,chunk=>{outputLength+=chunk.length,arr.push(Uint8Array.from(chunk))});if(ret===0)throw new Error("silk encoding failure");return{data:concat(arr,outputLength).slice(0,-1),duration:ret}}async function decode(input,sampleRate){let instance=await silk_wasm_default(),buffer=ArrayBuffer.isView(input)?input.buffer:input,arr=[],outputLength=0,ret=instance.silk_decode(buffer,buffer.byteLength,sampleRate,chunk=>{outputLength+=chunk.length,arr.push(Uint8Array.from(chunk))});if(ret===0)throw new Error("silk decoding failure");return{data:concat(arr,outputLength),duration:ret}}function getDuration(silk,frameMs=20){let buffer=ArrayBuffer.isView(silk)?silk.buffer:silk,offset=silk[0]===2?10:9,i=0,view=new DataView(buffer);for(;offset<view.byteLength;){let size=view.getUint16(offset,!0);offset+=2,i+=1,offset+=size}return i*frameMs}function isWav(fileData){return isWavFile(fileData)}export{decode,encode,getDuration,isWav};
